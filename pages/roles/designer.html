<!DOCTYPE html>
<html>

<head>
  <meta charset="UTF-8" />
  <meta name="renderer" content="webkit" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
  <meta name="viewport" content="width=device-width,initial-scale=1,minimum-scale=1,maximum-scale=1,user-scalable=no" />
  <title>设计师个人信息设置</title>
  <link rel="stylesheet" type="text/css" href="../../lib/layui/css/layui.css" />
  <link rel="stylesheet" href="../../lib/webuploader/webuploader.css">
  <style>
    .layui-input:focus, .layui-textarea:focus {
      border-color: rgb(240, 97, 47)!important;
    }
    body {
      background-color: #fff;
      padding-right: 20px;
      padding-left: 20px;
    }
    .hide {
      display: none!important;
    }
    .layui-form-item .layui-input-inline.fln {
      float: none;
    }
    .dib {
      display: inline-block;
    }
    .w80.layui-input-inline {
      width: 80px;
    }
    .w100.layui-input-inline {
      width: 100px;
    }
    .w120.layui-input-inline {
      width: 120px;
    }
    .w150.layui-input-inline {
      width: 150px;
    }
    .w200.layui-input-inline {
      width: 200px;
    }
    .color-red {
      color: red;
    }
    /* 水平线 */
    .hr-primary {
      height: 2px;
      background-color: rgb(240, 97, 47);
    }

    h2.title {
      height: 50px;
      line-height: 50px;
    }

    a.layui-btn:hover {
      border-color: rgb(240, 97, 47);
    }

    .high-light-text {
      font-weight: bold;
      color: rgb(240, 97, 47)!important;
    }

    /* 按钮样式 */
    .primary-btn {
      color: #fff;
      background-color: rgb(240, 97, 47) !important;
    }
    .plain-btn {
      background-color: #fff;
      color: rgb(240, 97, 47) !important;
      border: 1px solid rgb(240, 97, 47) !important;
    }


    /* ============== */
    .layui-form {
      margin-top: 20px;
    }
    .layui-form-label {
      width: 120px;
    }


    /*  */
    .upload-container-multi,
    .upload-container {
      position: relative;
      min-height: 120px;
      margin-left: 150px;
    }
    .upload-container-multi .picker-btn {
      padding: 0;
      background-color: transparent;
    }
    .upload-container .picker-btn {
      position: absolute;
      top: 0;
      left: 0;
      padding: 0;
      z-index: 100;
      background-color: transparent;
    }
    .upload-container-multi .picker-btn .webuploader-pick,
    .upload-container .picker-btn .webuploader-pick {
      width: 100%;
      height: 100%;
      padding: 0 18px;
      background-color: transparent;
      box-sizing: border-box;
      color: rgb(240, 97, 47);
    }
    .upload-container .file-list {
      position: absolute;
      top: 0;
      left: 0;
      padding: 0;
      z-index: 99;
    }
    .file-item.thumbnail img {
      width: 100px;
      height: 100px;
    }
  </style>
</head>

<body>
  <div class="order-page layui-row">
    <h2 class="title">设计师个人信息设置</h2>
    <div class="hr-primary"></div>
    <form class="layui-form" action="" lay-filter="form">

      <div class="layui-form-item form-item">
        <label class="layui-form-label">姓名：</label>
        <div class="layui-input-inline w150">
          <input type="text" name="username" required lay-verify="required|space|symbol|zh|length_4_10" placeholder="请输入姓名" autocomplete="off" class="layui-input">
        </div>
        <div class="layui-form-mid layui-word-aux high-light-text">设计师专属ID：GZ20181113001</div>
      </div>

      <div class="layui-form-item form-item">
        <label class="layui-form-label">联系人手机：</label>
        <div class="layui-input-inline w150">
          <input type="text" name="phone" lay-verify="required|phone|myphone" placeholder="请输入手机号" autocomplete="off" class="layui-input">
        </div>
        <div class="layui-form-mid layui-word-aux">绑定手机号默认平台后台不可修改，可在商户后台校验后修改</div>
      </div>

      <div class="layui-form-item form-item">
        <label class="layui-form-label">合同状态：</label>
        <div class="layui-input-inline w150">
          <select name="合同状态" required lay-verify="required">
            <option value="010">合作</option>
            <option value="021">中止</option>
          </select>
        </div>
      </div>

      <div class="layui-form-item form-item">
        <label class="layui-form-label">抬头：</label>
        <div class="layui-input-inline w150">
          <select name="抬头" required lay-verify="required">
            <option value="优秀设计师">优秀设计师</option>
            <option value="精英设计师">精英设计师</option>
            <option value="知名设计师">知名设计师</option>
            <option value="首席设计师">首席设计师</option>
            <option value="设计师大师 V">设计师大师 V</option>
          </select>
        </div>
      </div>
      <div class="layui-form-item form-item">
        <label class="layui-form-label">角色排序：</label>
        <div class="layui-input-inline w150">
          <select name="角色排序" required lay-verify="required">
            <option value="1">1</option>
            <option value="2">2</option>
          </select>
        </div>
      </div>
      
      <div class="layui-form-item layui-form-text">
        <label class="layui-form-label">头像：</label>
        <div class="layui-input-block upload-container">
          <a id="picker1" class="plain-btn picker-btn layui-btn" style="width: 100px; height: 100px; line-height: 100px; text-align: center;">上传图片</a>
          <div id="fileList1" class="file-list">
            <!-- 图片 -->
            <div class="file-item thumbnail"><img src=""></div>
          </div>
          <div class="layui-form-mid layui-word-aux" style="margin-left: 120px;">
            <p>上传尺寸：200×200像素，仅支持JPG、PNG图片文件，</p>
            <p></p>文件小于2M（尽可能保持面部清晰，便于业主辨识，增强信任度）</p>
          </div>
        </div>
      </div>

      <div class="layui-form-item layui-form-text">
        <label class="layui-form-label">生活照：</label>
        <div class="layui-input-block upload-container">
          <a id="picker2" class="plain-btn picker-btn layui-btn" style="width: 100px; height: 100px; line-height: 100px; text-align: center;">上传图片</a>
          <div id="fileList2" class="file-list"></div>
          <div class="layui-form-mid layui-word-aux" style="margin-left: 120px;">
            <p>上传尺寸：200×200像素，仅支持JPG、PNG图片文件，</p>
            <p></p>文件小于2M（将作为设计师招牌在设计师详情页展示，尽可能为全身照，增强信任度）</p>
          </div>
        </div>
      </div>

      <div class="layui-form-item form-item">
        <label class="layui-form-label">从业时间：</label>
        <div class="layui-input-inline w150">
          <input type="text" name="time" required lay-verify="required" placeholder="请选择日期" class="layui-input" id="work-time">
        </div>
        <div class="layui-form-mid layui-word-aux">系统将自动计算从业年限</div>
      </div>

      <div class="layui-form-item form-item">
        <label class="layui-form-label">擅长风格：</label>
        <div class="layui-input-inline" style="width: auto;">
          <input type="checkbox" lay-filter="checkboxs" name="roomType[1]" title="局部" lay-skin="primary">
          <input type="checkbox" lay-filter="checkboxs" name="roomType[2]" title="一居室" lay-skin="primary">
          <input type="checkbox" lay-filter="checkboxs" name="roomType[3]" title="两居室" lay-skin="primary">
          <input type="checkbox" lay-filter="checkboxs" name="roomType[4]" title="三居室" lay-skin="primary">
          <input type="checkbox" lay-filter="checkboxs" name="roomType[5]" title="四居室" lay-skin="primary">
          <input type="checkbox" lay-filter="checkboxs" name="roomType[6]" title="复式" lay-skin="primary">
          <input type="checkbox" lay-filter="checkboxs" name="roomType[7]" title="别墅" lay-skin="primary">
          <input type="checkbox" lay-filter="checkboxs" name="roomType[8]" title="简装" lay-skin="primary">
          <input type="checkbox" lay-filter="checkboxs" name="roomType[9]" title="工装" lay-skin="primary">
          <input type="checkbox" lay-filter="checkboxs" name="roomType[10]" title="新房" lay-skin="primary">
          <input type="checkbox" lay-filter="checkboxs" name="roomType[11]" title="期房" lay-skin="primary">
          <p style="margin: 10px 0;color: #bbb;">* 最多选择3个</p>
        </div>
      </div>

      <div class="layui-form-item form-item">
        <label class="layui-form-label">设计费：</label>
        <div class="layui-input-inline w150">
          <input type="text" name="设计费：" required lay-verify="required" placeholder="" autocomplete="off" class="layui-input">
        </div>
        <div class="layui-form-mid layui-word-aux">元/平方米</div>
      </div>

      <div class="layui-form-item form-item">
        <label class="layui-form-label">个人简介：</label>
        <div class="layui-input-inline" style="width: 50%;">
          <textarea name="个人简介" required lay-verify="required" placeholder="最多1000字符" class="layui-textarea"></textarea>
        </div>
      </div>

      <div class="layui-form-item layui-form-text">
        <label class="layui-form-label">证书/锦旗/荣誉：</label>
        <div class="layui-input-block upload-container-multi">
          <a id="picker3" class="plain-btn picker-btn layui-btn" style="margin-right: 20px;width: 100px; height: 100px; line-height: 100px; text-align: center;">上传图片</a>
          <div id="fileList3" class="file-list dib" style="vertical-align: top;"></div>
        </div>
      </div>

      <!-- 保存信息按钮 -->
      <div class="layui-form-item">
        <div class="layui-input-block" style="margin-left: 150px;">
          <button class="search-btn primary-btn layui-btn" lay-submit lay-filter="submit">
            保存信息
          </button>
        </div>
      </div>
    </form>
  </div>
  <script src="../../lib/layui/layui.js"></script>
  <script src="../../lib/jquery.min.js"></script>
  <script src="../../lib/webuploader//webuploader.html5only.min.js"></script>
  <script src="../../scripts/picUploader.js"></script>
  <script src="../../scripts/custom-verify.js"></script>
  <script>
    //Demo
    layui.use(["form", "element", "laydate", "jquery"], function () {
      var form = layui.form;
      var element = layui.element;
      var $ = layui.jquery;
      var laydate = layui.laydate;
      form.verify(getCustomVerifyObj());

      //执行一个时间选择器laydate实例（从业时间）
      laydate.render({
        elem: '#work-time' //指定元素
      });

      form.render();

      //监听表单信息提交
      form.on("submit(submit)", function (data) {
        console.log("表单数据如下：");
        console.log(data.field); //当前容器的全部表单字段，名值对形式：{name: value}

        // 擅长风格
        var dataList = $("form").serializeArray();
        var roomTypeFilter = dataList.filter(function (item) {
          return item.name.indexOf('roomType') !== -1
        });
        if (!roomTypeFilter.length) {
          layer.msg("擅长风格至少选择一个", { icon: 5 });
          return false;
        }

        layer.msg("打开开发者控制台查看保存信息");
        // return false; // 阻止表单跳转
      });
      // 复选框选中事件
      form.on('checkbox(checkboxs)', function (data) {
        var dataList = $("form").serializeArray();
        var filter = dataList.filter(function (item) {
          return item.name === 'roomType[]'
        });
        if (filter.length > 3) {
          layer.msg("擅长风格最多选择3个", { icon: 5 });
          $(data.elem).next().trigger('click');
        }
      });

      var uploader1 = singlePicUploader({
        $fileList: $("#fileList1"),
        server: "",  // 文件上传地址
        pick: "#picker1",
      })
      var uploader2 = singlePicUploader({
        $fileList: $("#fileList2"),
        server: "",  // 文件上传地址
        pick: "#picker2",
      })

      var uploader = designerMultiPicUploader({
        $fileList: $("#fileList3"),
        server: "",  // 文件上传地址
        pick: "#picker3",
        success: function () {

        },
        registerDeleteHandler: function (uploader) {
          $('.upload-container-multi').on('click', '.dele-pic-btn', function () {
            var $item = $(this).parents('.file-item')
            var fid = $item.attr('id')
            $item.remove();
            uploader.removeFile(fid, true)
          })
        }
      })


      initFormValue()

      function initFormValue () {
        var qs = location.search.split('?')[1];
        var json = {}
        if (!qs) { return false; }
        qs.split('&').forEach(function(item) {
          var temp = item.split('=');
          var key = decodeURI(temp[0]);
          var value = decodeURI(temp[1]);
          if (key.indexOf('room') !== -1) {
            
            json[key] = value;
            // if (json['room[]']) {
            //   json['room[]'].push(value);
            // }
            // json['room[]'] = [value];
          } else if (key.indexOf('honor_path') !== -1) {
            if (typeof json['honor_path[]']) {
              json['honor_path[]'].push(value);
            }
            json['honor_path[]'] = [value];
          }else {
            json[key] = value;
          }
        })
        console.log('表单数据是：', json);
        form.val("form", json);

        // 头像图片和生活照
        var src = 'http://www.ruanyifeng.com/blogimg/asset/2015/bg2015071010.png'
        $("#fileList1").append('<div class="file-item thumbnail"><img src="' + src + '"></div>')
        $("#fileList2").append('<div class="file-item thumbnail"><img src="' + src + '"></div>')

        // 证书/锦旗/荣誉
        if (json['honor_path[]'] && json['honor_path[]'].length) {
          json['honor_path[]'].forEach(function(src) {
            $("#fileList3").append('<div class="file-item thumbnail"><img src="' + src + '"></div>')
          });
        }
      }
    });
  </script>
</body>

</html>